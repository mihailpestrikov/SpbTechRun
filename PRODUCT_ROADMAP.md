# План развития SpbTechRun 2025

> Стратегический план развития системы рекомендаций

---

## Фаза 1: Базовая функциональность

### 1.1 Система сортировок

Добавить гибкие варианты сортировки товаров и рекомендаций.

**Варианты сортировки:**
- По цене (возрастание и убывание)
- По популярности (на основе просмотров, добавлений в корзину, заказов)

**Где применяется:**
- Каталог товаров
- Результаты поиска
- Рекомендации на странице товара

---

### 1.2 Рандомизация выдачи (Thompson Sampling)

Добавить элемент случайности в рекомендации для баланса между проверенными товарами и новыми предложениями.

**Проблема:**
Сейчас система всегда показывает одни и те же топовые рекомендации, что приводит к:
- Отсутствию разнообразия в выдаче
- "Холодному старту" для новых товаров
- Недостатку данных для улучшения модели

**Решение:**
Использовать байесовский подход Thompson Sampling, который:
- Балансирует показ товаров с высоким рейтингом (exploitation) и новых товаров (exploration)
- Автоматически адаптируется на основе получаемого фидбека
- Вес случайной компоненты регулируется параметром (по умолчанию 30% exploration)

---

### 1.3 ML-модель комплементарных категорий

Разработать специализированную модель для определения пар дополняющих друг друга категорий товаров.

**Проблема:**
Текущая система не всегда различает:
- Комплементарные товары (штукатурка + шпатель) — нужно рекомендовать
- Товары-заменители (штукатурка Knauf + штукатурка Ceresit) — не нужно в сопутствующих

**Цель модели:**
Предсказывать, являются ли две категории комплементарными на основе:
- Данных из сценариев ремонта (высокое качество)
- Статистики совместных покупок
- Фидбека пользователей
- Обученных эмбеддингов категорий

**Применение:**
- Фильтрация кандидатов перед CatBoost ранжированием
- Улучшение качества сценарных рекомендаций
- Автоматическое обнаружение новых комплементарных пар

---

### 1.4 Фильтры в каталоге (Faceted Search)

Использовать возможности Elasticsearch для создания многомерной фильтрации товаров.

**Типы фильтров:**
- По категориям (древовидная структура)
- По брендам/производителям
- По ценовому диапазону
- По наличию на складе
- По наличию скидки

**Возможности:**
- Агрегации показывают количество товаров для каждого фильтра
- Комбинирование нескольких фильтров одновременно
- Сохранение состояния фильтров в URL

---

### 1.5 Wishlist / Избранное

Возможность сохранять товары для последующей покупки.

**Функциональность:**
- Добавление/удаление товаров в избранное
- Работа для авторизованных и анонимных пользователей
- Объединение wishlist при авторизации
- Рекомендации на основе всех товаров в wishlist

**Применение:**
- Для отложенных покупок (планирование ремонта)
- Для сравнения товаров перед решением
- Для списков желаний

---

## Фаза 2: Улучшение пользовательского опыта

### 2.1 Блок "Похожие товары"

Добавить отдельный блок похожих товаров на странице товара.

**Отличие от сопутствующих товаров:**
- Похожие — для сравнения и выбора альтернатив (штукатурка Knauf → штукатурка Ceresit)
- Сопутствующие — для дополнения покупки (штукатурка → шпатель, грунтовка)

**Технология:**
Использование FAISS для поиска по семантическому сходству эмбеддингов.

---

### 2.2 История просмотров

Отображение недавно просмотренных товаров для быстрого возврата к ним.

**Где показывается:**
- На главной странице ("Вы недавно смотрели")
- В корзине
- В личном кабинете

**Функциональность:**
- Хранение последних 50 просмотренных товаров
- Для авторизованных и анонимных пользователей
- Автоматическая очистка через 30 дней

---

## Фаза 3: Операционная зрелость

### 3.1 Monitoring & Metrics (Prometheus + Grafana)

Внедрение комплексного мониторинга технических и бизнес-метрик.

**Технические метрики:**
- Латентность API запросов
- Частота запросов
- Процент ошибок
- Использование ресурсов
- Производительность FAISS, CatBoost, Elasticsearch
- Cache hit rate для Redis

**Бизнес-метрики:**
- Конверсионная воронка (просмотр → корзина → покупка)
- CTR рекомендаций
- Approval rate рекомендаций
- Средний чек
- Количество товаров на заказ

**Дашборды:**
1. System Health — общее состояние системы
2. ML Performance — производительность ML-компонентов
3. Business Metrics — бизнес-показатели

---

## Приоритизация задач

### Высокий приоритет
1. Система сортировок
2. Wishlist/Избранное
3. Фильтры в каталоге
4. Thompson Sampling
5. ML-модель комплементарных категорий

### Средний приоритет
6. История просмотров
7. Похожие товары
8. Monitoring & Metrics

---

## Заключение

План развития фокусируется на трёх направлениях:

1. **Улучшение пользовательского опыта** — сортировки, фильтры, wishlist, история
2. **Повышение качества рекомендаций** — Thompson Sampling, модель комплементарных категорий
3. **Операционная зрелость** — мониторинг и метрики

Приоритет отдаётся фичам с максимальным бизнес-импактом и разумной сложностью реализации.
